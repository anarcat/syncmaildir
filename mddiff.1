.\"Text automatically generated by txt2man
.TH mddiff 1 "10 April 2009" "" "smd (Sync Mail Dir) documentation"
.SH NAME
\fBmddiff \fP- computes diff for maildirs
.SH SYNOPSIS
.nf
.fam C
\fBmddiff\fP [\fB--max-mailno\fP \fImno\fP] [\fB--db-file\fP \fIdbf\fP] [\fB-v\fP|\fB--verbose\fP] [\fB--help\fP] \fIpaths\fP
.fam T
.fi
.fam T
.fi
.SH DESCRIPTION
\fBmddiff\fP computes the delta from an old status of a maildir (previously
recorded in a support file, called db file) and the current status, 
generating a set of commands (a diff) that a third party software can 
apply to synchronize a (eventually remote) copy of the maildir.
.PP
If \fIpaths\fP is a list of regular files, \fBmddiff\fP outputs the sha1 of its header
and body separated by space.
.PP
.nf
.fam C
      $ mddiff mddiff.c LICENSE Makefile 
      806a0ffe4f29766effd764\.\.\. 463e543da9dac8e298\.\.\.
      582cbb6a5cd3ce13965c8c\.\.\. 8fa60a7458b1157193\.\.\.
      da60957614a4c2f8ebc4c0\.\.\. 51980702755973efae\.\.\.

.fam T
.fi
If \fIpaths\fP is a list of directories, \fBmddiff\fP outputs a list of actions a client
has to perform to syncronize a copy of the same maildirs. This set of actions
is relative to a previous status of the maildir stored in the db file.
The input directories are traversed recursively, and every file encountered
is a potential mail message (if it contains no \\n\\n it is skipped).
.PP
.nf
.fam C
      $ mddiff ~/Mail/
      ADD ~/Mail/cur/1239038050.14937_1.garfield:2,S 66532ebb05b252e\.\.\. 
      \.\.\.

.fam T
.fi
Regular files and directories cannot be mixed in \fIpaths\fP.
.PP
Every client must use a different db-file, and the db-file is strictly
related with the set of directories given as arguments, and should not
be used with a different directory set. Adding items to the directory
set is safe, while removing them may not do what you want (delete actions
are generated).
.PP
\fBmddiff\fP does not alter the \fIdbf\fP file, it generates a new one called dbf.new.
It is up to the higher level tool \fBsmd-server\fP(1) to rename dbf.new to \fIdbf\fP 
in case the other endpoint successfully applied the diff.
.SH OPTIONS
.TP
.B
\fB--max-mailno\fP \fImno\fP
Estimation of max mail message number (default 500000)
Decrease for small systems, it is increased
automatically if needed
.TP
.B
\fB--db-file\fP \fIdbf\fP
Name of the cache for the endpoint (default db.txt)
.TP
.B
\fB-v\fP \fB--verbose\fP
Increase program verbosity (printed on stderr)
.TP
.B
\fB--help\fP
This help screen
.SH NOTES
\fBmddiff\fP is a low level utility, used by smd-server and smd-client. You
should use higher level tools like \fBsmd-pull\fP(1) and \fBsmd-push\fP(1)
.SH SEE ALSO
\fBsmd-client\fP(1), \fBsmd-server\fP(1), \fBsmd-pull\fP(1), \fBsmd-push\fP(1)
.SH AUTHOR
Enrico Tassi <gares@fettunta.org>
